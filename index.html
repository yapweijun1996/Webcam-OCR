<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Real-time Webcam OCR using Gemma-3-27B-IT model">
    <title>Webcam OCR - Real-time Text Recognition</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>Webcam OCR</h1>
            <div class="status-indicator" id="statusIndicator">
                <span class="status-dot"></span>
                <span class="status-text">Initializing...</span>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Camera Section -->
            <section class="camera-section">
                <div class="camera-container">
                    <video id="cameraFeed" autoplay playsinline muted></video>
                    <canvas id="captureCanvas" style="display: none;"></canvas>
                    <div class="camera-overlay" id="cameraOverlay">
                        <div class="capture-indicator">
                            <div class="capture-pulse"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Controls Section -->
            <section class="controls-section">
                <div class="control-buttons">
                    <button id="startBtn" class="btn btn-primary">
                        <span class="btn-icon">üé•</span>
                        Start Camera
                    </button>
                    <button id="captureBtn" class="btn btn-secondary" disabled>
                        <span class="btn-icon">üì∏</span>
                        Capture & OCR
                    </button>
                    <button id="stopBtn" class="btn btn-danger" disabled>
                        <span class="btn-icon">‚èπÔ∏è</span>
                        Stop
                    </button>
                </div>

                <!-- Debug Info (only show in development) -->
                <div class="debug-info" id="debugInfo" style="display: none;">
                    <details>
                        <summary>Debug Information</summary>
                        <div class="debug-content">
                            <p><strong>Browser:</strong> <span id="debugBrowser"></span></p>
                            <p><strong>HTTPS:</strong> <span id="debugHttps"></span></p>
                            <p><strong>Camera API:</strong> <span id="debugCameraAPI"></span></p>
                            <p><strong>Stream Status:</strong> <span id="debugStream"></span></p>
                            <p><strong>Video Dimensions:</strong> <span id="debugVideoSize"></span></p>
                        </div>
                    </details>
                </div>

                <div class="control-options">
                    <div class="option-group">
                        <label>
                            <input type="radio" name="captureMode" id="modeInterval" value="interval">
                            <span class="option-label">Auto-capture every 1s</span>
                        </label>
                        <label>
                            <input type="radio" name="captureMode" id="modeAsync" value="async" checked>
                            <span class="option-label">Async Capture OCR</span>
                        </label>
                    </div>
                    <label class="option-group">
                        <input type="checkbox" id="showPreview" checked>
                        <span class="option-label">Show capture preview</span>
                    </label>
                </div>

                <!-- Model Selection -->
                <div class="model-selection">
                    <label for="modelSelect">AI Model:</label>
                    <select id="modelSelect" class="model-select">
                        <option value="gemini-flash-lite-latest">Gemini Flash Lite (Fast)</option>
                        <option value="gemma-3-27b-it">Gemma 3 27B (Advanced OCR)</option>
                    </select>
                    <div class="model-info" id="modelInfo">Fast model optimized for speed and efficiency</div>
                </div>
            </section>

            <!-- Results Section -->
            <section class="results-section">
                <div class="results-header">
                    <h2>OCR Results</h2>
                    <button id="clearBtn" class="btn btn-outline">Clear</button>
                    <button id="testBtn" class="btn btn-outline" style="margin-left: 10px;">Test Display</button>
                </div>

                <div class="results-container">
                    <div id="resultsList" class="results-list">
                        <!-- Results will be inserted here -->
                    </div>

                    <div id="errorMessage" class="error-message" style="display: none;">
                        <p class="error-text"></p>
                    </div>
                </div>
            </section>

            <!-- Processing Indicator - More prominent position -->
            <div id="processingIndicator" class="processing-indicator" style="display: none;">
                <div class="processing-content">
                    <div class="processing-spinner"></div>
                    <div class="processing-text">
                        <h3>Processing Image</h3>
                        <p>Analyzing with Gemma-3-27B-IT...</p>
                        <div class="processing-progress">
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <p>Powered by Gemma-3-27B-IT | Real-time OCR System</p>
        </footer>
    </div>

    <script src="gemini-config.js"></script>
    <script src="script.js"></script>
</body>
</html>